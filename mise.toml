[tasks.lint]
description = "Run oxlint [path]"
usage = 'arg "[path]" help="File or directory to lint" default="src/"'
run = "bunx oxlint --type-aware ${usage_path}"

[tasks."lint:fix"]
description = "Run oxlint with auto-fix [path]"
usage = 'arg "[path]" help="File or directory to lint" default="src/"'
run = "bunx oxlint --type-aware --fix-dangerously ${usage_path}"

[tasks.format]
description = "Run oxfmt to format files [path]"
usage = 'arg "[path]" help="File or directory to format" default="src/"'
run = "bunx oxfmt ${usage_path}"

[tasks."format:check"]
description = "Check formatting without changes [path]"
usage = 'arg "[path]" help="File or directory to check" default="src/"'
run = "bunx oxfmt --check ${usage_path}"

[tasks.typecheck]
description = "Run tsgo type checking"
run = "bunx tsgo --noEmit"

[tasks.check]
description = "Run all read-only checks (typecheck, lint, format:check)"
run = '''
#!/bin/bash
exit_code=0
echo "=== TypeCheck ===" && bunx tsgo --noEmit || exit_code=1
echo ""
echo "=== Lint ===" && bunx oxlint --type-aware src/ || exit_code=1
echo ""
echo "=== Format Check ===" && bunx oxfmt --check src/ || exit_code=1
exit $exit_code
'''

[tasks.fix]
description = "Apply auto-fixes (lint:fix, format)"
run = '''
#!/bin/bash
exit_code=0
echo "=== Lint Fix ===" && bunx oxlint --type-aware --fix-dangerously src/ || exit_code=1
echo ""
echo "=== Format ===" && bunx oxfmt src/ || exit_code=1
exit $exit_code
'''
